import{u as e}from"./order-store.0b99a3d0.js";import{d as t,a2 as a,r,Z as l,a4 as s,z as u,b as o,e as d,f as c,A as n,h as i,p,m as f,t as x,N as m,a5 as b,s as _,B as h,C as g,D as v,M as y,a6 as w}from"./index.4b002d2b.js";import{u as j}from"./hook-handler.d0811128.js";import{_ as k}from"./sc-number-box.81c41bd6.js";import{_ as q}from"./sc-button.3d3eb510.js";import{t as C}from"./index.dfc28261.js";import{t as T,r as P}from"./route.99ab519a.js";import{_ as D}from"./_plugin-vue_export-helper.cdc0426e.js";import"./sc-icon.52d4ad3f.js";import"./uni-qrcode.a0d42b81.js";const Q=D(t({__name:"index",setup(t){const D=e(),Q=a(),{handlePulldownRefresh:z}=j(),A=r({quality:0,product:{}}),B=r(!1);function F(e){A.value.quality=e.value}const I=r(!1),M=r(!1);function N(){if(Q.getToken())I.value=!0,M.value=!0,setTimeout((()=>{I.value=!1,M.value=!1,b({url:"/pages/order/success/index?id=2"})}),1e3);else{C("请先登录");const e=m();B.value=!0;const t=e[e.length-1];setTimeout((()=>{P({url:"/pages/auth/login/index",mode:"redirectTo",params:`?redirect=${t.route}`})}),1501)}}return l((()=>{const e=D.getCheckoutData();B.value=!1,e||(C("请选择下单商品！"),setTimeout((()=>{T()}),1501)),A.value=e})),s((()=>{B.value||D.clearCheckoutData()})),u(z),(e,t)=>{const a=_,r=h,l=g(v("sc-number-box"),k),s=y,u=g(v("sc-button"),q);return o(),d(a,{class:"order-checkout pt-36rpx leading-none"},{default:c((()=>[n(" 订单信息 "),i(a,{class:"mx-32rpx bg-white rounded-24rpx p-32rpx"},{default:c((()=>[i(a,{class:"font-600 text-32rpx"},{default:c((()=>[p(" 订单信息 ")])),_:1}),i(a,{class:"h-120rpx flex mt-32rpx"},{default:c((()=>[i(a,{class:"w-120rpx h-full mr-32rpx flex-shrink-0"},{default:c((()=>[i(r,{src:f(A).product.cover,mode:"aspectFill",class:"w-full h-full"},null,8,["src"])])),_:1}),i(a,{class:"h-full w-full flex flex-col justify-between"},{default:c((()=>[i(a,{class:"text-32rpx w-full line-clamp-2"},{default:c((()=>[p(x(f(A).product.name),1)])),_:1}),i(a,{class:"w-full flex items-center justify-between"},{default:c((()=>[i(a,{class:"font-600"},{default:c((()=>[p(" ￥"+x(f(A).product.price),1)])),_:1}),i(a,{class:"flex items-center"},{default:c((()=>[f(A).product.maxPurchaseQuantity?(o(),d(a,{key:0,class:"text-20rpx mr-8rpx"},{default:c((()=>[p(" （每车限购"+x(f(A).product.maxPurchaseQuantity||0)+"件） ",1)])),_:1})):n("v-if",!0),i(a,{class:"border-2rpx rounded-24rpx border-gray-200"},{default:c((()=>[i(l,{value:f(A).quality,min:1,max:f(A).product.maxPurchaseQuantity||f(A).product.stock,"icon-color":"#333","background-color":"transparent",onChange:F},null,8,["value","max"])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),i(a,{class:"border-t-1rpx border-gray-light pt-32rpx flex justify-between items-center mt-32rpx"},{default:c((()=>[i(a,null,{default:c((()=>[p("小计")])),_:1}),i(a,{class:"text-32rpx font-600 text-error"},{default:c((()=>[p(" ￥"+x(f(A).quality*f(A).product.price),1)])),_:1})])),_:1})])),_:1}),n(" 购买须知 "),i(a,{class:"mx-32rpx bg-white rounded-24rpx mt-32rpx p-32rpx text-gray-light leading-normal"},{default:c((()=>[i(a,{class:"text-32rpx font-600 text-black mb-28rpx leading-none"},{default:c((()=>[p(" 购买须知 ")])),_:1}),i(a,null,{default:c((()=>[p("1、须知")])),_:1}),i(a,null,{default:c((()=>[p("2、须知")])),_:1}),i(a,null,{default:c((()=>[p("3、须知须知须知须知须知")])),_:1})])),_:1}),n(" submit bar "),i(a,{class:"bg-white fixed left-0 bottom-0 right-0 z-2 pt-16rpx px-32rpx flex items-center justify-between submit-bar"},{default:c((()=>[i(a,null,{default:c((()=>[p(" 实付金额："),i(s,{class:"text-40rpx font-500 text-error"},{default:c((()=>[p(" ￥"+x(f(A).quality*f(A).product.price),1)])),_:1})])),_:1}),i(a,null,{default:c((()=>[i(u,{width:"240rpx",height:"80rpx",radius:"80rpx",background:f(w),loading:f(I),disabled:f(M),onClick:N},{default:c((()=>[i(a,{class:"text-32rpx font-500 text-white"},{default:c((()=>[p(" 确认支付 ")])),_:1})])),_:1},8,["background","loading","disabled"])])),_:1})])),_:1})])),_:1})}}}),[["__scopeId","data-v-7f0f4bd1"]]);export{Q as default};
