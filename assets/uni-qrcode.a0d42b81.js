var t=Object.defineProperty,e=(e,r,s)=>(((e,r,s)=>{r in e?t(e,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[r]=s})(e,"symbol"!=typeof r?r+"":r,s),s);import{U as r,V as s,W as o,X as i,Y as n}from"./index.4b002d2b.js";const h=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]],a={L:1,M:0,Q:3,H:2},l=1,u=2,g=4,c=8;function d(t,e){let r=1;const s=function(t){const e=encodeURI(t).toString().replace(/\%[0-9a-fA-F]{2}/g,"a");return e.length+(e.length!==t?3:0)}(t);for(let o=0,i=h.length;o<=i;o++){let t=0;switch(e){case a.L:t=h[o][0];break;case a.M:t=h[o][1];break;case a.Q:t=h[o][2];break;case a.H:t=h[o][3]}if(s<=t)break;r++}if(r>h.length)throw new Error("Too long data");return r}class f{constructor(t){e(this,"data"),e(this,"parsedData",[]),e(this,"mode",g),this.data=t;for(let e=0,r=this.data.length;e<r;e++){const t=[],r=this.data.charCodeAt(e);r>65536?(t[0]=240|(1835008&r)>>>18,t[1]=128|(258048&r)>>>12,t[2]=128|(4032&r)>>>6,t[3]=128|63&r):r>2048?(t[0]=224|(61440&r)>>>12,t[1]=128|(4032&r)>>>6,t[2]=128|63&r):r>128?(t[0]=192|(1984&r)>>>6,t[1]=128|63&r):t[0]=r,this.parsedData.push(t)}this.parsedData=Array.prototype.concat.apply([],this.parsedData),this.parsedData.length!==this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),this.parsedData.unshift(239))}getLength(){return this.parsedData.length}write(t){for(let e=0,r=this.parsedData.length;e<r;e++)t.put(this.parsedData[e],8)}}const m=class{constructor(t,r){e(this,"modules",null),e(this,"moduleCount",0),e(this,"dataCache",null),e(this,"dataList",[]),e(this,"errorCorrectLevel"),e(this,"typeNumber"),this.typeNumber=t,this.errorCorrectLevel=r}addData(t){const e=new f(t);this.dataList.push(e),this.dataCache=null}isDark(t,e){if(t<0||this.moduleCount<=t||e<0||this.moduleCount<=e)throw new Error(`${t},${e}`);return this.modules[t][e]}getModuleCount(){return this.moduleCount}make(){this.makeImpl(!1,this.getBestMaskPattern())}makeImpl(t,e){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(let r=0;r<this.moduleCount;r++){this.modules[r]=new Array(this.moduleCount);for(let t=0;t<this.moduleCount;t++)this.modules[r][t]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(t,e),this.typeNumber>=7&&this.setupTypeNumber(t),null==this.dataCache&&(this.dataCache=m.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,e)}setupPositionProbePattern(t,e){for(let r=-1;r<=7;r++)if(!(t+r<=-1||this.moduleCount<=t+r))for(let s=-1;s<=7;s++)e+s<=-1||this.moduleCount<=e+s||(this.modules[t+r][e+s]=r>=0&&r<=6&&(0===s||6===s)||s>=0&&s<=6&&(0===r||6===r)||r>=2&&r<=4&&s>=2&&s<=4)}getBestMaskPattern(){let t=0,e=0;for(let r=0;r<8;r++){this.makeImpl(!0,r);const s=E.getLostPoint(this);(0===r||t>s)&&(t=s,e=r)}return e}createMovieClip(t,e,r){const s=t.createEmptyMovieClip(e,r);this.make();for(let o=0;o<this.modules.length;o++){const t=1*o;for(let e=0;e<this.modules[o].length;e++){const r=1*e;this.modules[o][e]&&(s.beginFill(0,100),s.moveTo(r,t),s.lineTo(r+1,t),s.lineTo(r+1,t+1),s.lineTo(r,t+1),s.endFill())}}return s}setupTimingPattern(){for(let t=8;t<this.moduleCount-8;t++)null===this.modules[t][6]&&(this.modules[t][6]=t%2==0);for(let t=8;t<this.moduleCount-8;t++)null==this.modules[6][t]&&(this.modules[6][t]=t%2==0)}setupPositionAdjustPattern(){const t=E.getPatternPosition(this.typeNumber);for(let e=0;e<t.length;e++)for(let r=0;r<t.length;r++){const s=t[e],o=t[r];if(null==this.modules[s][o])for(let t=-2;t<=2;t++)for(let e=-2;e<=2;e++)this.modules[s+t][o+e]=-2===t||2===t||-2===e||2===e||0===t&&0===e}}setupTypeNumber(t){const e=E.getBCHTypeNumber(this.typeNumber);for(let r=0;r<18;r++){const s=!t&&1==(e>>r&1);this.modules[Math.floor(r/3)][r%3+this.moduleCount-8-3]=s}for(let r=0;r<18;r++){const s=!t&&1==(e>>r&1);this.modules[r%3+this.moduleCount-8-3][Math.floor(r/3)]=s}}setupTypeInfo(t,e){const r=this.errorCorrectLevel<<3|e,s=E.getBCHTypeInfo(r);for(let o=0;o<15;o++){const e=!t&&1==(s>>o&1);o<6?this.modules[o][8]=e:o<8?this.modules[o+1][8]=e:this.modules[this.moduleCount-15+o][8]=e}for(let o=0;o<15;o++){const e=!t&&1==(s>>o&1);o<8?this.modules[8][this.moduleCount-o-1]=e:o<9?this.modules[8][15-o-1+1]=e:this.modules[8][15-o-1]=e}this.modules[this.moduleCount-8][8]=!t}mapData(t,e){let r=-1,s=this.moduleCount-1,o=7,i=0;for(let n=this.moduleCount-1;n>0;n-=2)for(6===n&&n--;;){for(let r=0;r<2;r++)if(null==this.modules[s][n-r]){let h=!1;i<t.length&&(h=1==(t[i]>>>o&1));E.getMask(e,s,n-r)&&(h=!h),this.modules[s][n-r]=h,o--,-1===o&&(i++,o=7)}if(s+=r,s<0||this.moduleCount<=s){s-=r,r=-r;break}}}static createData(t,e,r){const s=I.getRSBlocks(t,e),o=new M;for(let n=0;n<r.length;n++){const e=r[n];o.put(e.mode,4),o.put(e.getLength(),E.getLengthInBits(e.mode,t)),e.write(o)}let i=0;for(let n=0;n<s.length;n++)i+=s[n].dataCount;if(o.getLengthInBits()>8*i)throw new Error(`code length overflow. (${o.getLengthInBits()}>${8*i})`);for(o.getLengthInBits()+4<=8*i&&o.put(0,4);o.getLengthInBits()%8!=0;)o.putBit(!1);for(;!(o.getLengthInBits()>=8*i||(o.put(m.PAD0,8),o.getLengthInBits()>=8*i));)o.put(m.PAD1,8);return m.createBytes(o,s)}static createBytes(t,e){let r=0,s=0,o=0;const i=new Array(e.length),n=new Array(e.length);for(let u=0;u<e.length;u++){const h=e[u].dataCount,a=e[u].totalCount-h;s=Math.max(s,h),o=Math.max(o,a),i[u]=new Array(h);for(let e=0;e<i[u].length;e++)i[u][e]=255&t.buffer[e+r];r+=h;const l=E.getErrorCorrectPolynomial(a),g=new b(i[u],l.getLength()-1).mod(l);n[u]=new Array(l.getLength()-1);for(let t=0;t<n[u].length;t++){const e=t+g.getLength()-n[u].length;n[u][t]=e>=0?g.get(e):0}}let h=0;for(let u=0;u<e.length;u++)h+=e[u].totalCount;const a=new Array(h);let l=0;for(let u=0;u<s;u++)for(let t=0;t<e.length;t++)u<i[t].length&&(a[l++]=i[t][u]);for(let u=0;u<o;u++)for(let t=0;t<e.length;t++)u<n[t].length&&(a[l++]=n[t][u]);return a}};let p=m;e(p,"PAD0",236),e(p,"PAD1",17);const C=0,L=1,w=2,B=3,D=4,k=5,y=6,P=7,_={glog(t){if(t<1)throw new Error(`glog(${t})`);return _.LOG_TABLE[t]},gexp(t){for(;t<0;)t+=255;for(;t>=256;)t-=255;return _.EXP_TABLE[t]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)},A=class{static getBCHTypeInfo(t){let e=t<<10;for(;A.getBCHDigit(e)-A.getBCHDigit(A.G15)>=0;)e^=A.G15<<A.getBCHDigit(e)-A.getBCHDigit(A.G15);return(t<<10|e)^A.G15_MASK}static getBCHTypeNumber(t){let e=t<<12;for(;A.getBCHDigit(e)-A.getBCHDigit(A.G18)>=0;)e^=A.G18<<A.getBCHDigit(e)-A.getBCHDigit(A.G18);return t<<12|e}static getBCHDigit(t){let e=0;for(;0!==t;)e++,t>>>=1;return e}static getPatternPosition(t){return A.PATTERN_POSITION_TABLE[t-1]}static getMask(t,e,r){switch(t){case C:return(e+r)%2==0;case L:return e%2==0;case w:return r%3==0;case B:return(e+r)%3==0;case D:return(Math.floor(e/2)+Math.floor(r/3))%2==0;case k:return e*r%2+e*r%3==0;case y:return(e*r%2+e*r%3)%2==0;case P:return(e*r%3+(e+r)%2)%2==0;default:throw new Error(`bad maskPattern:${t}`)}}static getErrorCorrectPolynomial(t){let e=new b([1],0);for(let r=0;r<t;r++)e=e.multiply(new b([1,_.gexp(r)],0));return e}static getLengthInBits(t,e){if(e>=1&&e<10)switch(t){case l:return 10;case u:return 9;case g:case c:return 8;default:throw new Error(`mode:${t}`)}else if(e<27)switch(t){case l:return 12;case u:return 11;case g:return 16;case c:return 10;default:throw new Error(`mode:${t}`)}else{if(!(e<41))throw new Error(`type:${e}`);switch(t){case l:return 14;case u:return 13;case g:return 16;case c:return 12;default:throw new Error(`mode:${t}`)}}}static getLostPoint(t){const e=t.getModuleCount();let r=0;for(let o=0;o<e;o++)for(let s=0;s<e;s++){let i=0;const n=t.isDark(o,s);for(let r=-1;r<=1;r++)if(!(o+r<0||e<=o+r))for(let h=-1;h<=1;h++)s+h<0||e<=s+h||0===r&&0===h||n===t.isDark(o+r,s+h)&&i++;i>5&&(r+=3+i-5)}for(let o=0;o<e-1;o++)for(let s=0;s<e-1;s++){let e=0;t.isDark(o,s)&&e++,t.isDark(o+1,s)&&e++,t.isDark(o,s+1)&&e++,t.isDark(o+1,s+1)&&e++,0!==e&&4!==e||(r+=3)}for(let o=0;o<e;o++)for(let s=0;s<e-6;s++)t.isDark(o,s)&&!t.isDark(o,s+1)&&t.isDark(o,s+2)&&t.isDark(o,s+3)&&t.isDark(o,s+4)&&!t.isDark(o,s+5)&&t.isDark(o,s+6)&&(r+=40);for(let o=0;o<e;o++)for(let s=0;s<e-6;s++)t.isDark(s,o)&&!t.isDark(s+1,o)&&t.isDark(s+2,o)&&t.isDark(s+3,o)&&t.isDark(s+4,o)&&!t.isDark(s+5,o)&&t.isDark(s+6,o)&&(r+=40);let s=0;for(let o=0;o<e;o++)for(let r=0;r<e;r++)t.isDark(r,o)&&s++;return r+=10*(Math.abs(100*s/e/e-50)/5),r}};let E=A;e(E,"PATTERN_POSITION_TABLE",[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]]),e(E,"G15",1335),e(E,"G18",7973),e(E,"G15_MASK",21522);for(let R=0;R<8;R++)_.EXP_TABLE[R]=1<<R;for(let R=8;R<256;R++)_.EXP_TABLE[R]=_.EXP_TABLE[R-4]^_.EXP_TABLE[R-5]^_.EXP_TABLE[R-6]^_.EXP_TABLE[R-8];for(let R=0;R<255;R++)_.LOG_TABLE[_.EXP_TABLE[R]]=R;class b{constructor(t,r){if(e(this,"num"),void 0===t.length)throw new Error(`${t.length}/${r}`);let s=0;for(;s<t.length&&0===t[s];)s++;this.num=new Array(t.length-s+r);for(let e=0;e<t.length-s;e++)this.num[e]=t[e+s]}get(t){return this.num[t]}getLength(){return this.num.length}multiply(t){const e=new Array(this.getLength()+t.getLength()-1);for(let r=0;r<this.getLength();r++)for(let s=0;s<t.getLength();s++)e[r+s]^=_.gexp(_.glog(this.get(r))+_.glog(t.get(s)));return new b(e,0)}mod(t){if(this.getLength()-t.getLength()<0)return this;const e=_.glog(this.get(0))-_.glog(t.get(0)),r=new Array(this.getLength());for(let s=0;s<this.getLength();s++)r[s]=this.get(s);for(let s=0;s<t.getLength();s++)r[s]^=_.gexp(_.glog(t.get(s))+e);return new b(r,0).mod(t)}}const T=class{constructor(t,r){e(this,"dataCount"),e(this,"totalCount"),this.totalCount=t,this.dataCount=r}static getRSBlocks(t,e){const r=T.getRsBlockTable(t,e);if(void 0===r)throw new Error(`bad rs block @ typeNumber:${t}/errorCorrectLevel:${e}`);const s=r.length/3,o=[];for(let i=0;i<s;i++){const t=r[3*i+0],e=r[3*i+1],s=r[3*i+2];for(let r=0;r<t;r++)o.push(new T(e,s))}return o}static getRsBlockTable(t,e){switch(e){case a.L:return T.RS_BLOCK_TABLE[4*(t-1)+0];case a.M:return T.RS_BLOCK_TABLE[4*(t-1)+1];case a.Q:return T.RS_BLOCK_TABLE[4*(t-1)+2];case a.H:return T.RS_BLOCK_TABLE[4*(t-1)+3];default:return}}};let I=T;e(I,"RS_BLOCK_TABLE",[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]]);class M{constructor(){e(this,"length"),e(this,"buffer"),this.buffer=[],this.length=0}get(t){const e=Math.floor(t/8);return 1==(this.buffer[e]>>>7-t%8&1)}put(t,e){for(let r=0;r<e;r++)this.putBit(1==(t>>>e-r-1&1))}getLengthInBits(){return this.length}putBit(t){const e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++}}class O{constructor(t,r){if(e(this,"_htOption"),e(this,"canvasId"),e(this,"_oQRCode"),this._htOption={width:256,height:256,typeNumber:4,colorDark:"#000000",colorLight:"#ffffff",correctLevel:a.H},"string"==typeof r&&(r={text:r}),r)for(const e in r)this._htOption[e]=r[e];this._oQRCode=null,this.canvasId=t,this._htOption.text&&this.canvasId&&this.makeCode(this._htOption.text)}makeCode(t){this._oQRCode=new p(d(t,this._htOption.correctLevel),this._htOption.correctLevel),this._oQRCode.addData(t),this._oQRCode.make(),this.makeImage()}makeImage(){let t;t=this._htOption.usingIn?i(this.canvasId,this._htOption.usingIn):i(this.canvasId);const e=this._htOption,r=this._oQRCode,s=r.getModuleCount(),o=e.width/s,n=e.height/s,h=Math.round(o),a=Math.round(n);e.image&&""!==e.image&&t.drawImage(e.image,0,0,e.width,e.height);for(let i=0;i<s;i++)for(let l=0;l<s;l++){const s=r.isDark(i,l),u=l*o,g=i*n;t.setStrokeStyle(s?e.colorDark:e.colorLight),t.setLineWidth(1),t.setFillStyle(s?e.colorDark:e.colorLight),t.fillRect(u,g,o,n),t.strokeRect(Math.floor(u)+.5,Math.floor(g)+.5,h,a),t.strokeRect(Math.ceil(u)-.5,Math.ceil(g)-.5,h,a)}t.draw()}exportImage(t,e){t&&n({x:0,y:0,width:this._htOption.width,height:this._htOption.height,destWidth:this._htOption.width,destHeight:this._htOption.height,canvasId:this.canvasId,success(e){t(e.tempFilePath)},fail:t=>{e&&e(t.errMsg?JSON.stringify(t.errMsg):JSON.stringify(t)),console.error(t.errMsg||JSON.stringify(t))}})}}function v(t,e,i,n=520){r({});const h=new O(e,{width:n,height:n,colorDark:"#333333",colorLight:"#FFFFFF",text:t,correctLevel:O.CorrectLevel.H});h.makeImage(),h.exportImage((t=>{i.value=t,s()}),(t=>{s(),o({title:t,icon:"none"})}))}e(O,"CorrectLevel",a);export{v as g};
